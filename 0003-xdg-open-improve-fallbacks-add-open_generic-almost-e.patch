From abd6cef36874f73c5c1c4a734d83eba9d340afe4 Mon Sep 17 00:00:00 2001
From: Rex Dieter <rdieter@math.unl.edu>
Date: Sat, 19 Dec 2015 11:08:59 -0600
Subject: [PATCH 3/8] xdg-open: improve fallbacks, add open_generic (almost)
 everywhere (BR93442)

---
 ChangeLog           |  3 +++
 scripts/xdg-open.in | 18 +++++++++++++++---
 2 files changed, 18 insertions(+), 3 deletions(-)

diff --git a/ChangeLog b/ChangeLog
index deaa86e..e8a6e40 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,5 +1,8 @@
 === xdg-utils 1.1.2 (unreleased) ===
 
+2015-12-19 Rex Dieter <rdieter@fedoraproject.org>
+   * xdg-open: improve fallbacks, add open_generic (almost) everywhere (BR93442)
+
 2015-11-03 Per Olofsson <pelle@debian.org>
    * Check for $WAYLAND_DISPLAY as well as $DISPLAY. Move display checking
      to a common has_display() function. Thanks to Pasi SjÃ¶holm for reporting.
diff --git a/scripts/xdg-open.in b/scripts/xdg-open.in
index 92a5912..4578753 100644
--- a/scripts/xdg-open.in
+++ b/scripts/xdg-open.in
@@ -178,8 +178,10 @@ open_mate()
 {
     if gvfs-open --help 2>/dev/null 1>&2; then
         gvfs-open "$1"
-    else
+    elif mate-open --help >/dev/null 2>&1; then
         mate-open "$1"
+    else
+        open_generic "$1"
     fi
 
     if [ $? -eq 0 ]; then
@@ -191,7 +193,13 @@ open_mate()
 
 open_xfce()
 {
-    exo-open "$1"
+    if exo-open --help 2>/dev/null 1>&2; then
+        exo-open "$1"
+    elif gvfs-open --help 2>/dev/null 1>&2; then
+        gvfs-open "$1"
+    else
+        open_generic "$1"
+    fi
 
     if [ $? -eq 0 ]; then
         exit_success
@@ -202,7 +210,11 @@ open_xfce()
 
 open_enlightenment()
 {
-    enlightenment_open "$1"
+    if enlightenment_open --help 2>/dev/null 1>&2; then
+        enlightenment_open "$1"
+    else
+        open_generic "$1"
+    fi
 
     if [ $? -eq 0 ]; then
         exit_success
-- 
1.9.5

